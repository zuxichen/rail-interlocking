\documentclass[10pt,a4paper]{report}
\usepackage{bsymb,b2latex}
\begin{document}
\SingleHeader{SR\_M0}
\MACHINE{SR\_M0}{}{SR0\_Path}{}
\VARIABLES{
	\Variable{Route\_Req}{}
	\Variable{Route\_Cel}{}
	\Variable{Route\_Occ}{}
	\Variable{Route2Path}{}
}
\INVARIANTS{
	\Invariant{inv1}{false}{$Route\_Req \subseteq{} ROUTE$}{}
	\Invariant{inv2}{false}{$Route\_Cel \subseteq{} ROUTE$}{}
	\Invariant{inv3}{false}{$Route\_Occ \subseteq{} ROUTE$}{}
	\Invariant{inv4}{false}{$Route2Path \in{} ROUTE \pfun{} PATH$}{}
	\Invariant{inv5}{false}{$\forall{}r1,r2\qdot{}(r1 \neq{} r2 \land{} r1 \in{} dom(Route2Path) \land{} r2 \in{} dom(Route2Path)) \limp{} (PathConflict\converse{}[Route2Path[\{r1\}]] \binter{} Route2Path[\{r2\}] = \emptyset{}) $}{}
	\Invariant{inv6}{false}{$\forall{}r\qdot{}r\in{}Route\_Occ \limp{} (Route2Path[\{r\}] \neq{} \emptyset{})$}{}
}
\EVENTS{
\INITIALISATION{false}{}{
	\ACTIONS{false}{
		\Action{act1}{$Route\_Req  \bcmeq{}  \emptyset{}$}{true}{}
		\Action{act2}{$Route\_Cel  \bcmeq{}  \emptyset{}$}{true}{}
		\Action{act3}{$Route\_Occ \bcmeq{} \emptyset{}$}{true}{}
		\Action{act4}{$Route2Path \bcmeq{} \emptyset{}$}{true}{}
	}
}
\EVT{ATS\_Request}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \notin{} Route\_Req$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route\_Req \bcmeq{} Route\_Req \bunion{} \{r\}$}{true}{}
	}
}
\EVT{Route\_Reserve}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \in{} Route\_Req$}{true}{}
		\Guard{grd2}{false}{$r \notin{} Route\_Cel$}{true}{}
		\Guard{grd3}{false}{$r \notin{} dom(Route2Path)$}{true}{}
		\Guard{grd4}{false}{$PathConflict[Route2InitPath[\{r\}]] \binter{} ran(Route2Path)=\emptyset{}$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route2Path \bcmeq{} Route2Path \bunion{} \{r\mapsto{}Route2InitPath(r)\} $}{true}{}
	}
}
\EVT{Train\_Enter}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \in{} dom(Route2Path)$}{true}{}
		\Guard{grd2}{false}{$r \notin{} Route\_Occ$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route\_Occ \bcmeq{} Route\_Occ \bunion{} \{r\}$}{true}{}
	}
}
\EVT{Route\_Sequential\_Release}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
		\Param{cp}{true}{}
		\Param{sp}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \in{} Route\_Occ$}{true}{}
		\Guard{grd2}{false}{$r \in{} dom(Route2Path)$}{true}{}
		\Guard{grd3}{false}{$cp = Route2Path(r)$}{true}{}
		\Guard{grd4}{false}{$cp \neq{} NullPath$}{true}{}
		\Guard{grd5}{false}{$sp \in{} PathSub[\{cp\}]$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route2Path(r) \bcmeq{} sp$}{true}{}
	}
}
\EVT{Train\_Leave}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \in{} Route\_Occ$}{true}{}
		\Guard{grd2}{false}{$r \in{} dom(Route2Path)$}{true}{}
		\Guard{grd3}{false}{$Route2Path(r) = NullPath$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route\_Occ \bcmeq{} Route\_Occ \setminus{} \{r\}$}{true}{}
	}
}
\EVT{Route\_Release}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \in{} dom(Route2Path)$}{true}{}
		\Guard{grd2}{false}{$Route2Path(r) = NullPath$}{true}{}
		\Guard{grd3}{false}{$r \notin{} Route\_Occ$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route2Path \bcmeq{} \{r\} \domsub{} Route2Path $}{true}{}
		\Action{act2}{$Route\_Req \bcmeq{} Route\_Req \setminus{} \{r\}$}{true}{}
	}
}
\EVT{ATS\_Cancel}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \in{} Route\_Req$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route\_Cel \bcmeq{} Route\_Cel \bunion{} \{r\}$}{true}{}
	}
}
\EVT{Route\_Cancel}{false}{ordinary}{}{}{
	\ANY{
		\Param{r}{true}{}
	}
	\GUARDS{true}{
		\Guard{grd1}{false}{$r \in{} Route\_Req$}{true}{}
		\Guard{grd2}{false}{$r \in{} Route\_Cel $}{true}{}
		\Guard{grd3}{false}{$r \notin{} Route\_Occ$}{true}{}
		\Guard{grd4}{false}{$r \in{} dom(Route2Path)$}{true}{}
	}
	\ACTIONS{true}{
		\Action{act1}{$Route\_Req \bcmeq{} Route\_Req \setminus{} \{r\}$}{true}{}
		\Action{act2}{$Route\_Cel \bcmeq{} Route\_Cel \setminus{} \{r\}$}{true}{}
		\Action{act3}{$Route2Path \bcmeq{} \{r\} \domsub{} Route2Path $}{true}{}
	}
}
}
\END
\end{document}
